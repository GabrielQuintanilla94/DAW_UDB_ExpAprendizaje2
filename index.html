<!DOCTYPE html>
<html lang="es">
  <link rel="icon" type="image/png" href="imagenes/logo.jpg" />
<head>
  <meta charset="utf-8" />
  <title>Pokémon Bank – Cajero</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Fuente -->
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- Bootstrap 4 -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

  <!-- Estilos propios -->
  <link rel="stylesheet" href="estilos.css" />
</head>
<body class="bg-light">

  <!-- Header -->
  <header class="bg-dark text-white py-3">
  <div class="container d-flex flex-column flex-md-row align-items-md-center justify-content-between">
    <div class="d-flex align-items-center">
      <h1 class="h4 mb-2 mb-md-0">Pokémon Bank – Cajero</h1>
    </div>
    <div id="userInfo" class="small d-flex align-items-center text-right d-none">
      <div>
        <div><strong>Titular:</strong> <span id="ownerName">Ash Ketchum</span></div>
        <div><strong>Cuenta:</strong> <span id="accountNumber">001-234-567</span></div>
      </div>
      <img src="imagenes/logo.jpg" alt="Logo Pokémon Bank" style="height:48px; width:auto; margin-left:14px;">
    </div>
  </div>
</header>

<section id="view-soporte" class="d-none">
  <div class="card shadow-sm mx-auto" style="max-width:500px;">
    <div class="card-body">
      <h5 class="mb-3">¿Tienes algún problema?</h5>
      <form id="frmSoporte">
        <div class="form-group">
          <textarea class="form-control" id="problema" rows="4" placeholder="Describe tu problema aquí..."></textarea>
        </div>
        <button type="submit" class="btn btn-primary btn-block">Enviar</button>
      </form>
      <button id="btnSalirSoporte" class="btn btn-secondary btn-block mt-3">Salir</button>
      <div class="mt-4 text-center">
        <strong>Contáctanos</strong><br>
        <span class="d-block">Correo: <a href="mailto:pokemonbank@gmail.com">pokemonbank@gmail.com</a></span>
        <span class="d-block">Teléfono: 0176 8745</span>
      </div>
    </div>
  </div>
</section>

  <main class="container py-4">

    <!-- LOGIN (PIN 4 dígitos) -->
    <section id="view-login">
      <div class="row justify-content-center">
        <div class="col-md-6 col-lg-5">
          <div class="card shadow-sm">
            <div class="card-body">
              <h2 class="h5 mb-3">Iniciar sesión</h2>
              <p class="text-muted mb-4">Ingrese su PIN de 4 dígitos.</p>

              <form id="frmLogin" novalidate>
                <div class="form-group">
                  <label for="pin">PIN</label>
                  <input type="password"
       id="pin"
       class="form-control"
       maxlength="4"
       pattern="\d{4}"
       required>
                  <small class="form-text text-muted">Solo números (4 dígitos).</small>
                  <div class="invalid-feedback">Ingrese un PIN válido de 4 dígitos.</div>
                </div>
                <button type="submit" class="btn btn-primary btn-block">Entrar</button>
              </form>

              <div id="loginMsg" class="mt-3 small text-danger d-none">PIN incorrecto.</div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- DASHBOARD (acciones + lateral) -->
    <section id="view-dashboard" class="d-none">
      <div class="row">
        <!-- Principal -->
        <div class="col-lg-8 mb-4">
          <!-- Tabs de acciones -->
          <ul class="nav nav-tabs" id="tabsAcciones" role="tablist">
            <li class="nav-item"><a class="nav-link active" data-toggle="tab" href="#tabDeposito" role="tab">Depósito</a></li>
            <li class="nav-item"><a class="nav-link" data-toggle="tab" href="#tabRetiro" role="tab">Retiro</a></li>
            <li class="nav-item"><a class="nav-link" data-toggle="tab" href="#tabConsulta" role="tab">Consulta</a></li>
            <li class="nav-item"><a class="nav-link" data-toggle="tab" href="#tabPagos" role="tab">Pagos</a></li>
          </ul>

          <div class="tab-content border-left border-right border-bottom p-3 bg-white">
            <!-- Depósito -->
            <div class="tab-pane fade show active" id="tabDeposito" role="tabpanel">
              <form id="frmDeposito" class="form-inline">
                <label class="sr-only" for="montoDeposito">Monto</label>
                <div class="input-group mr-2 mb-2">
                  <div class="input-group-prepend"><span class="input-group-text">$</span></div>
                  <input type="number" class="form-control" id="montoDeposito" min="0.01" step="any" placeholder="Monto">
                </div>
                <button class="btn btn-success mb-2" type="submit">Depositar</button>
              </form>
              <small class="text-muted">Ej.: sueldo, efectivo, etc.</small>
            </div>

            <!-- Retiro -->
            <div class="tab-pane fade" id="tabRetiro" role="tabpanel">
              <form id="frmRetiro" class="form-inline">
                <label class="sr-only" for="montoRetiro">Monto</label>
                <div class="input-group mr-2 mb-2">
                  <div class="input-group-prepend"><span class="input-group-text">$</span></div>
                  <input type="number" class="form-control" id="montoRetiro" min="0.01" step="any" placeholder="Monto">
                </div>
                <button class="btn btn-danger mb-2" type="submit">Retirar</button>
              </form>
              <small class="text-muted">Se validará que el saldo sea suficiente.</small>
            </div>

            <!-- Consulta -->
            <div class="tab-pane fade" id="tabConsulta" role="tabpanel">
              <h3 class="h5">Saldo actual</h3>
              <div class="display-4" id="saldoActual">$0</div>
            </div>

            <!-- Pagos -->
            <div class="tab-pane fade" id="tabPagos" role="tabpanel">
              <form id="frmPagoServicios" class="form-inline flex-wrap">
                <label class="mr-2 mb-2" for="servicio">Servicio</label>
                <select id="servicio" class="form-control mr-2 mb-2">
                  <option value="Electricidad">Electricidad</option>
                  <option value="Internet">Internet</option>
                  <option value="Telefonía">Telefonía</option>
                  <option value="Agua">Agua</option>
                </select>

                <label class="sr-only" for="montoServicio">Monto</label>
                <div class="input-group mr-2 mb-2">
                  <div class="input-group-prepend"><span class="input-group-text">$</span></div>
                  <input type="number" id="montoServicio" class="form-control" min="0.01" step="any" placeholder="Monto">
                </div>

                <button class="btn btn-warning mb-2" type="submit">Pagar</button>
              </form>
              <small class="text-muted">El pago se incluirá en el historial.</small>
            </div>
          </div>
        </div>

        <!-- Lateral -->
        <aside class="col-lg-4">
          <div class="card mb-3">
            <div class="card-body">
              <button id="btnVerHistorial" class="btn btn-outline-secondary btn-block mb-2">Ver historial (panel)</button>
              <button id="btnVerGrafico" class="btn btn-outline-secondary btn-block mb-2">Ver gráfico (panel)</button>

              <hr>
              <button id="btnAbrirHistorialVista" class="btn btn-outline-primary btn-block mb-2">Historial (vista)</button>
              <button id="btnAbrirGraficoVista" class="btn btn-outline-primary btn-block mb-2">Gráfico (vista)</button>
              <button id="btnBorrarHistorial" class="btn btn-outline-danger btn-block mb-2">Borrar historial</button>
              <button id="btnExportarPDF" class="btn btn-outline-success btn-block">Exportar historial (PDF)</button>

              <hr>
              <button id="btnSalir" class="btn btn-outline-dark btn-block">Salir</button>
            </div>
          </div>

          <div class="card">
            <div class="card-body">
              <h5 class="card-title">Saldo</h5>
              <div id="saldoSidebar" class="h3 mb-0">$0</div>
            </div>
          </div>
        </aside>
      </div>

      <!-- Historial (panel en dashboard) -->
      <div id="panelHistorial" class="card shadow-sm d-none">
        <div class="card-body">
          <h3 class="h5 mb-3">Historial de transacciones</h3>
          <div class="table-responsive">
            <table class="table table-sm table-striped mb-0">
              <thead class="thead-dark">
                <tr>
                  <th>Fecha</th>
                  <th>Tipo</th>
                  <th>Detalle</th>
                  <th class="text-right">Monto</th>
                </tr>
              </thead>
              <tbody id="tablaHistorial"></tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Gráfica (panel en dashboard) -->
      <div id="panelGrafico" class="card shadow-sm d-none mt-3">
        <div class="card-body">
          <h3 class="h5 mb-3">Análisis por tipo</h3>
          <canvas id="chartTipos" height="120"></canvas>
        </div>
      </div>
    </section>

    <!-- VISTA: HISTORIAL (pantalla dedicada) -->
    <section id="view-history" class="d-none">
      <div class="card shadow-sm">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center mb-3">
            <h3 class="h5 mb-0">Historial de transacciones</h3>
            <div>
              <button id="btnExportarPDFTop" class="btn btn-sm btn-success mr-2">Exportar PDF</button>
              <button id="btnVolverDashboard1" class="btn btn-sm btn-secondary">Volver</button>
            </div>
          </div>
          <div class="table-responsive">
            <table class="table table-sm table-striped mb-0">
              <thead class="thead-dark">
                <tr>
                  <th>Fecha</th>
                  <th>Tipo</th>
                  <th>Detalle</th>
                  <th class="text-right">Monto</th>
                </tr>
              </thead>
              <tbody id="tablaHistorial2"></tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <!-- VISTA: GRÁFICO (pantalla dedicada) -->
    <section id="view-chart" class="d-none">
      <div class="card shadow-sm">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center mb-3">
            <h3 class="h5 mb-0">Análisis por tipo</h3>
            <button id="btnVolverDashboard2" class="btn btn-sm btn-secondary">Volver</button>
          </div>
          <canvas id="chartTiposVista" height="160"></canvas>
        </div>
      </div>
    </section>

  </main>

  <footer class="bg-dark text-white py-3 mt-4">
    <a href="https://www.x.com" class="text-white">Twitter</a>
    <a href="https://www.instagram.com" class="text-white">| Instagram</a>
    <a href="https://www.facebook.com" class="text-white">| Facebook</a>
    <span id="soporteLink" style="cursor:pointer;">| Soporte</span>
    <div class="container text-center small">© 2025 Pokémon Bank – Universidad Don Bosco</div>
  </footer>

  <!-- JS Bootstrap + Chart + jsPDF + App -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
  <script src="app.js"></script>
</body>
</html>